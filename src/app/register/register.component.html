<div class="register-container">
    <section
        class="register-form-section"
        aria-label="Formulario de registro de Geographia"
    >
        <header class="header">
            <h1 class="company-name" tabindex="0" (click)="goToMap()">
                GEOGRAPHIA
            </h1>
        </header>

        <div class="form-content">
            <h2 class="title" tabindex="0">Registro</h2>
            <p class="subtitle" tabindex="0">
                Registrándote estás aceptando nuestros
                <a
                    href="#"
                    target="_blank"
                    rel="noopener noreferrer"
                    aria-describedby="terms-desc"
                    >Términos y Políticas de Privacidad</a
                >
            </p>
            <span id="terms-desc" class="sr-only"
                >Se abrirá en una nueva ventana</span
            >

            <nav
                class="tab-switch"
                role="tablist"
                aria-label="Navegación entre Inicio y Registro"
            >
                <span
                    class="inactive"
                    role="tab"
                    tabindex="0"
                    aria-selected="false"
                    (click)="goToLogin()"
                    (keydown.enter)="goToLogin()"
                    aria-label="Apreta el boton Enter para ir a la pestaña de Inicio"
                    >Inicio</span
                >
                <span
                    class="active"
                    role="tab"
                    tabindex="-1"
                    aria-selected="true"
                    aria-current="page"
                    >Registro</span
                >
            </nav>
            <form
                aria-label="Formulario de registro"
                [formGroup]="registerForm"
                (ngSubmit)="onSubmit()"
            >
                <div class="wrapper">
                    <label for="email" class="sr-only"
                        >Correo Electrónico</label
                    >
                    <span class="material-symbols-outlined" aria-hidden="true"
                        >mail</span
                    >
                    <input
                        id="email"
                        type="email"
                        placeholder="Correo Electrónico"
                        required
                        autocomplete="email"
                        aria-required="true"
                        formControlName="email"
                    />
                </div>
                <div
                    *ngIf="
                        registerForm.get('email')?.touched &&
                        registerForm.get('email')?.invalid
                    "
                    class="error"
                    role="alert"
                    tabindex="0"
                >
                    <div
                        *ngIf="registerForm.get('email')?.errors?.['required']"
                    >
                        Este campo es obligatorio.
                    </div>
                    <div *ngIf="registerForm.get('email')?.errors?.['email']">
                        Debe ser un correo electrónico válido.
                    </div>
                    <div
                        *ngIf="registerForm.get('email')?.errors?.['maxLength']"
                    >
                        El correo electrónico no puede exceder los 50
                        caracteres.
                    </div>
                </div>

                <div class="name-fields">
                    <div>
                        <div class="wrapper" style="flex: 1">
                            <label for="nombre" class="sr-only">Nombre</label>
                            <span
                                class="material-symbols-outlined"
                                aria-hidden="true"
                                >person</span
                            >
                            <input
                                id="nombre"
                                type="text"
                                placeholder="Nombre"
                                required
                                autocomplete="given-name"
                                aria-required="true"
                                formControlName="first_name"
                            />
                        </div>
                        <div
                            *ngIf="
                                registerForm.get('first_name')?.touched &&
                                registerForm.get('first_name')?.invalid
                            "
                            class="error"
                            role="alert"
                            tabindex="0"
                        >
                            <div
                                *ngIf="registerForm.get('first_name')?.errors?.['required']"
                            >
                                Este campo es obligatorio.
                            </div>
                            <div
                                *ngIf="registerForm.get('first_name')?.errors?.['minlength']"
                            >
                                Debe tener al menos 2 caracteres.
                            </div>
                            <div
                                *ngIf="registerForm.get('first_name')?.errors?.['pattern']"
                            >
                                Solo se permiten letras y espacios.
                            </div>
                        </div>
                    </div>
                    <div>
                        <div class="wrapper" style="flex: 1">
                            <label for="apellido" class="sr-only"
                                >Apellido</label
                            >
                            <span
                                class="material-symbols-outlined"
                                aria-hidden="true"
                                >person</span
                            >
                            <input
                                id="apellido"
                                type="text"
                                placeholder="Apellido"
                                required
                                autocomplete="family-name"
                                aria-required="true"
                                formControlName="last_name"
                            />
                        </div>
                        <div
                            *ngIf="
                                registerForm.get('last_name')?.touched &&
                                registerForm.get('last_name')?.invalid
                            "
                            class="error"
                            role="alert"
                            tabindex="0"
                        >
                            <div
                                *ngIf="registerForm.get('last_name')?.errors?.['required']"
                            >
                                Este campo es obligatorio.
                            </div>
                            <div
                                *ngIf="registerForm.get('last_name')?.errors?.['minlength']"
                            >
                                Debe tener al menos 2 caracteres.
                            </div>
                            <div
                                *ngIf="registerForm.get('last_name')?.errors?.['pattern']"
                            >
                                Solo se permiten letras y espacios.
                            </div>
                        </div>
                    </div>
                </div>
                <div>
                    <div class="wrapper date-wrapper">
                        <label for="fecha-nacimiento" class="sr-only"
                            >Fecha de nacimiento</label
                        >
                        <span
                            class="material-symbols-outlined"
                            aria-hidden="true"
                            >calendar_month</span
                        >
                        <input
                            id="fecha-nacimiento"
                            type="date"
                            placeholder="Fecha de nacimiento"
                            required
                            aria-required="true"
                            formControlName="birth_date"
                        />
                    </div>
                    <div
                        *ngIf="
                            registerForm.get('birth_date')?.touched &&
                            registerForm.get('birth_date')?.invalid
                        "
                        class="error"
                        role="alert"
                        tabindex="0"
                    >
                        <div
                            *ngIf="registerForm.get('birth_date')?.errors?.['required']"
                        >
                            Este campo es obligatorio.
                        </div>
                        <div
                            *ngIf="registerForm.get('birth_date')?.errors?.['minAge']"
                        >
                            Debes tener al menos 13 años para registrarte.
                        </div>
                    </div>
                </div>
                <div>
                    <div class="wrapper">
                        <label for="password" class="sr-only">Contraseña</label>
                        <span
                            class="material-symbols-outlined"
                            aria-hidden="true"
                            >lock</span
                        >
                        <input
                            id="password"
                            [type]="showPassword ? 'text' : 'password'"
                            placeholder="Contraseña"
                            required
                            aria-required="true"
                            autocomplete="new-password"
                            formControlName="password"
                        />
                        <button
                            type="button"
                            class="toggle-password"
                            [attr.aria-pressed]="showPassword"
                            [attr.aria-label]="
                                showPassword
                                    ? 'Ocultar contraseña'
                                    : 'Mostrar contraseña'
                            "
                            (click)="togglePassword()"
                        >
                            <span class="material-symbols-outlined">
                                {{
                                    showPassword
                                        ? "visibility_off"
                                        : "visibility"
                                }}
                            </span>
                        </button>
                    </div>
                    <div
                        *ngIf="
                            registerForm.get('password')?.touched &&
                            registerForm.get('password')?.invalid
                        "
                        class="error"
                        role="alert"
                        tabindex="0"
                    >
                        <div
                            *ngIf="registerForm.get('password')?.errors?.['required']"
                        >
                            Este campo es obligatorio.
                        </div>
                        <div
                            *ngIf="registerForm.get('password')?.errors?.['minlength']"
                        >
                            La contraseña debe tener al menos 8 caracteres.
                        </div>
                    </div>
                </div>
                <div>
                    <div class="wrapper">
                        <label for="repeat-password" class="sr-only"
                            >Repetir contraseña</label
                        >
                        <span
                            class="material-symbols-outlined"
                            aria-hidden="true"
                            >lock</span
                        >
                        <input
                            id="repeat-password"
                            [type]="showRepeatPassword ? 'text' : 'password'"
                            placeholder="Repetir contraseña"
                            required
                            aria-required="true"
                            autocomplete="new-password"
                            formControlName="repeatPassword"
                        />
                        <button
                            type="button"
                            class="toggle-password"
                            [attr.aria-pressed]="showRepeatPassword"
                            [attr.aria-label]="
                                showRepeatPassword
                                    ? 'Ocultar contraseña'
                                    : 'Mostrar contraseña'
                            "
                            (click)="toggleRepeatPassword()"
                        >
                            <span class="material-symbols-outlined">
                                {{
                                    showRepeatPassword
                                        ? "visibility_off"
                                        : "visibility"
                                }}
                            </span>
                        </button>
                    </div>
                    <div
                        *ngIf="
                            registerForm.get('repeatPassword')?.touched &&
                            registerForm.get('repeatPassword')?.invalid
                        "
                        class="error"
                        role="alert"
                        tabindex="0"
                    >
                        <div
                            *ngIf="registerForm.get('repeatPassword')?.errors?.['required']"
                        >
                            Este campo es obligatorio.
                        </div>
                        <div
                            *ngIf="registerForm.get('repeatPassword')?.errors?.['minlength']"
                        >
                            La contraseña debe tener al menos 8 caracteres.
                        </div>
                    </div>

                    <div
                        *ngIf="registerForm.errors?.['passwordMismatch'] && registerForm.get('repeatPassword')?.touched"
                        class="error"
                        role="alert"
                        tabindex="0"
                    >
                        Las contraseñas no coinciden.
                    </div>
                </div>

                <button
                    type="submit"
                    class="button register-button"
                    aria-label="Registrarse"
                >
                    Registrarse
                </button>
            </form>
        </div>
    </section>
    <div class="gsi-material-button-state"></div>

    <section class="register-image-section" aria-hidden="true">
        <img src="/map.jpeg" alt="Mapa geográfico como imagen decorativa" />
    </section>
</div>
